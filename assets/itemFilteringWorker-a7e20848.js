(function(){"use strict";let d={id:"none"},o="ascending",c=null;const v=(r,t)=>{let n=g(r,t).filter(e=>E(e,t)&&T(e,t)&&F(e,t)&&p(e,t));m(n)},g=(r,t)=>{let l=t.sortBy,n=t.sortOrder,e=structuredClone(r);return l===d&&n===o||(d=l,o=n,l.id==="none")?e:e.sort((a,u)=>{if(l.id==="level")return n.id==="ascending"?a.level-u.level:u.level-a.level;if(l.id==="name"){let s=a.name.toLowerCase(),i=u.name.toLowerCase();return n.id==="ascending"?s<i?-1:s>i?1:0:s>i?-1:s<i?1:0}else return h(a,u,l,n)})},h=(r,t,l,n)=>{var u,s;let e=-1e4,a=-1e4;if((u=r.equipEffects)!=null&&u.length){let i=r.equipEffects.find(f=>f.id===l.id);i!==void 0&&(e=i.values[0])}if((s=t.equipEffects)!=null&&s.length){let i=t.equipEffects.find(f=>f.id===l.id);i!==void 0&&(a=i.values[0])}return n.id==="ascending"?e-a:a-e},E=(r,t)=>t.startLevel<=r.level&&r.level<=t.endLevel,T=(r,t)=>{var n;if(t.effectFilters.length===0)return!0;if(((n=r.equipEffects)==null?void 0:n.length)===void 0||r.equipEffects.length===0)return!1;let l=!0;return t.effectFilters.some(e=>{let a=c[e.type.value],u=!1;return r.equipEffects.some(s=>a.rawIds.includes(s.id)?(u=!0,e.comparator.id==="equalTo"?l=s.values[0]===e.value:e.comparator.id==="greaterThanOrEqualTo"?l=s.values[0]>=e.value:e.comparator.id==="lessThanOrEqualTo"?l=s.values[0]<=e.value:console.error("Unknown comparator when trying to evaluate effect filters."),!0):!1),u===!1&&(l=!1),l===!1}),l},F=(r,t)=>{let l=r.rarity,n=!1;return t.rarityFilters.some(e=>e.checked&&e.id===l?(n=!0,!0):!1),n},p=(r,t)=>{if(t.itemTypeFilters.length===0)return!0;let l=r.type.id,n=!1;return t.itemTypeFilters.some(e=>e.checked&&e.rawId===l?(n=!0,!0):!1),n},m=r=>{postMessage({items:r,error:null})};onmessage=async r=>{let t=r.data.params,l=r.data.itemData;c=r.data.EFFECT_TYPE_DATA,v(l,t)}})();
