(function(){"use strict";let o=null;const d=(r,e)=>{let n=c(r,e).filter(t=>h(t,e)&&E(t,e)&&m(t,e)&&F(t,e));T(n)},c=(r,e)=>{let l=structuredClone(r);for(let n in e.sortingParams){let t=e.sortingParams[n].sortBy,s=e.sortingParams[n].sortOrder;t.id!=="none"&&(l=l.sort((a,i)=>v(a,i,t,s)))}return l},v=(r,e,l,n)=>{if(l.id==="level")return n.id==="ascending"?r.level-e.level:e.level-r.level;if(l.id==="name"){let t=r.name.toLowerCase(),s=e.name.toLowerCase();return n.id==="ascending"?t<s?-1:t>s?1:0:t>s?-1:t<s?1:0}else return g(r,e,l,n)},g=(r,e,l,n)=>{var a,i;let t=-1e4,s=-1e4;if((a=r.equipEffects)!=null&&a.length){let u=r.equipEffects.find(f=>f.id===l.id);u!==void 0&&(t=u.values[0])}if((i=e.equipEffects)!=null&&i.length){let u=e.equipEffects.find(f=>f.id===l.id);u!==void 0&&(s=u.values[0])}return n.id==="ascending"?t-s:s-t},h=(r,e)=>e.startLevel<=r.level&&r.level<=e.endLevel,E=(r,e)=>{var n;if(e.effectFilters.length===0)return!0;if(((n=r.equipEffects)==null?void 0:n.length)===void 0||r.equipEffects.length===0)return!1;let l=!0;return e.effectFilters.some(t=>{let s=o[t.type.value],a=!1;return r.equipEffects.some(i=>s.rawIds.includes(i.id)?(a=!0,t.comparator.id==="equalTo"?l=i.values[0]===t.value:t.comparator.id==="greaterThanOrEqualTo"?l=i.values[0]>=t.value:t.comparator.id==="lessThanOrEqualTo"?l=i.values[0]<=t.value:console.error("Unknown comparator when trying to evaluate effect filters."),!0):!1),a===!1&&(l=!1),l===!1}),l},m=(r,e)=>{let l=r.rarity,n=!1;return e.rarityFilters.some(t=>t.checked&&t.id===l?(n=!0,!0):!1),n},F=(r,e)=>{if(e.itemTypeFilters.length===0)return!0;let l=r.type.id,n=!1;return e.itemTypeFilters.some(t=>t.checked&&t.rawId===l?(n=!0,!0):!1),n},T=r=>{postMessage({items:r,error:null})};onmessage=async r=>{let e=r.data.params,l=r.data.itemData;o=r.data.EFFECT_TYPE_DATA,d(l,e)}})();
